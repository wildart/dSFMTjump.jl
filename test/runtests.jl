using dSFMTjump

seed = 1234
step = 25000*2;
size = 4
jump25000  = "35931a4947eeab70a9abbfaca4a79cfcf2610a35a586c6f4e4bdfa826d538cbfb0432c37321fcec4f6c98de3df06685087032988b0ad9a2144562aa82e06f2f6f256b5b412c524e35383a894da7b04e142c4156290585186d8fc06d3141a778220c2519a851b5a9e5947a3f745b71804631988825e21dba40392ff4c036b30d2d013b45e2be94b5e130a9c6424d2e82f48c855c81bd10757fdb5a91e23e9e312e430514ea31631d8897b4cf26eb39b37be0c92706e5637d4b34c1e4046b741e455df195cb512e8e0f8d578175a3da5e00d7ce247d9b92042b1b515d01f7f89fe661ebccb06dfb77bc0fbb99806921b472ccce58f2166ac058d9cf427ad7d74986e60a56d2fee0a8b680e466a8ea4e508a76c058b6f97b99c9aa5b10297b1a1bd6a8e80f3a79e008fa55a4a8915fbdec78b6b117ad67e195311fe79fc084c33f6db546f5b7602d010fa8b830e3f1b00cef00ee16840178fc7e9aa5f1cee625d43de8488bf6c8bd379ea6f97c55c7a9ee091477a23533d5e52e194bd9d4e17b02a64a2736feb3779fabd5777e448ffee0f2d4b38a8e7441822b882fc6df0bde8541e85c0c78a05936cff0c88a50980b7a84971fba3650991fe2cba425ac4b4289e7b06ce2cfabfcc8a553201e8c74b45e4ae74b6d054e37af95e6fd55e029b7c526b85ecfb3be8db670218ee3dda7b2a54ab1ed26eefe4cd1d2a9c589a6e94d0aa3ebe29e40e616aa0b731061c3d6e247ec610024a1a97b7adb7919308b0fb5dd5d51a58aa2f55d77b88037de7c1a74823c96cb09d22dd7f90dba14eefdcffaab34d323c829f24742f6f6b32b0724a26ae4a81130a8a275d30c21e6245fa27cf26d606a49bccba2980697c32d9efe583c4ee2140569025c4f044d744bc40cec1660d9e4d2de3a4de83bae4f0a9fdb34ef4509b2b4e6c37967a485a52d69d1573bb826bc64c966de9c792b7c2f07b645c56a29381911a98928e48516f246a55bcaa78f3c7d1c30127df5f06ba0a2d6a5e54605a20e60fab30c01a9472cb610ca0ef2418a985af00c7e47539111bf539dd554297d0374a7ff627d879600595b442c8dcffcffa3bbb07e5c7882ff0858142be4deac448698f0917fe2b7a9b686a9df1fa929f06a51aff992a6ee0b0605f8b34b87600cfa0af2475333b78625ce1520c793dc5080218247b4e41bbd7d9dab163470fe17a3d2622cdce979cc5565b0bc04eabaf656f21fa072a18ab33c656b665248ef20321407fef263b1c67316f2c6f236951990099e42d4614d8e08b27aa89d9f4548fa321d4b381d2da04fd7f17d6b9a68adfd0e4427196d25dcad869f8a155c6242f7d072baa5e7405ceb65dfaa3eb864bfe679a17df34273fde5037befe9ed5391b932cee271f59128c61ab3f0fc3f7cf8ff051fbda8382c64579efddd494c79850c56bda73bcd39c20c2820d191995b3335253c3b0ac8f5e5373f40c228886e6c526c2c249a5304578ba2a80f591c34ca1eaa84d6cc9399cf3f1207e61c4acada647e4e87ad5fba84aeeff6b6881d35bda77c74384fc5e279a0f495d509bc882c2b8bc790651a6d7a4ecba23a3f05111e1d8be37c03439fbd484668ceab69a52b7d519b169cbbcf634ee5e3bf78a5f8771f95fea03f2cb889e116a9f5de3abeacb8e42475fb5d022484b02d11f1e406332e0a773098fc4f0baa57cda2863c554f291d4eb74e63e4b3d44b0ed156bff1820003d407a3aaa9e6dfaa226ba7ef2fd0eff90a5482926f47f24f67019edccb6fd329eef30b5fb2125276aa1fe75a702b32c907ab133c72a74e77e0a5eb48fc5176b9d65b75b0038e1a9ed74ec2a3dcd2348fa54256f082abc01a301bacef7380f20ee0411c08a35dafdaae9f9fc123448da28626ffcc654e9d522bc8b8776b13a3310f7eeb4d27290ef4cbc7492fbcb5409d455748a8a1f087430cf5e6f453e2caa0c5343fcf4374cc38bead49941d8ab59b4d5181716c238aa88dbf1c4a2da3a9a9b9435d5ee1d51d27b0655a4308c1252aaf633cd8f44a351ffc8cec65de0b7e4e2556100e2ae9bc511044351109a6254b2d387b1a72c768f43fa7be6b93806e323b55c3e7925ed627dc708fde0954b299b1ca33bb7fbe33e0f9e4ce5b4f26efaf8e5b9507ada4f8658998eb7167afbd4482ee47cc60f4039d6a77c1fb126033bfc2e7c6162ff7561f22e263325c53a014a4ac9390fe6fab5d433c1e9896fe561f22fc8290f3f4560b676f3dfbfd1fe605343a0685349241b83a28d61cc0292d1f638a36d3d87bfa9f72f9df1cfe90692dfda5bd5e698362f5316984cbe73a132a801acbca76b5f5c23d98a217f2159b6cbbcdf8f52d23ea24c9471a31562a651b20e05cd0300ee500a450cfdaa4d2d83f7e7e27f8b7c793cf80f8067dadef77e49a64c373b97bac4dd472e5145072c73d0fdd68d9646c8a8ed9aec6c40bc915ae44ae27391ca0f1a4d2cb1c3d097be614e6eba807f4549d769a5872f268ccf770f2682d844490348f0b6a0d2b51aadbb5523cf708b66f9928eed12b35a39cf42d283b29f5283e1c8ba1f73457af17b14cdfdf9a85b0589acf1f9504e46b0bab8be848dac5673587035b99f56c41d3195bbba1616b149a22193cfb760d6bf2d84861653cd21be9a2d33187cb25d47fbecdd4626d1d97202f460a39b7128cadb77ddf682feca61fb6de0290df598a565a6361a91d76c0c685046489ed4cb1dcc4f1cea849c12dc4a3d38d3010567f387590532b78927e92f0b718c84e882b3df071a78a011d0fd56d4101dcb009914a16a781b240a6fb2440c72b0ffb365be9d3459d114e665a0d35d7b8bd280101d85d1211d939ba0b15ab528c4f9dd2b001172561d211671b96873010ae3c2b8317f773d735698914228764b831423ae19dd4bbb008b9f1bd1e3ebdd626e629a46a9dd70bdd4bb30e2279e83c12bbbead6479b5f9980b1a9c785395520703a9367d931b45c1566c9d314b1745cafc6d0667cc9bc94d0c53a960c829eb09b768ab6bb2133e4fea1d939f3d3f8e1237210cf3577c830f0493073dc1d189abf27402b8b31b7c172c43dbf331a0828adfe737380e763d0ab0bfaaf94ec04830f94380a83718f340c4eeb20d7eb22b94613be84a9ed332ab364efff6cb37eec35d186185cca725e7a748f6bdb427604fb1628d49a7424a5a62a2e930fe142b035503af332fe748d5e63591b9ac54071ca843d5e474a48837de8b80387f3269ab50d2fd99c08c971e015d13fa02c7c315922ce58bdacbf8ee48827851a61fca59882d7eadcce3166dfe012aa9ec849e698e776a4d384f4755b506a222636942a81bbbffa1ff47e4d81fe68120aebcfd1a7e0000fd0cffdc44e1f0cd69ea2b4936564c78af51fed1cc8e34f0b46d6330b4b50ddee09335b7b0be0bc9f7f8e48415e15d08f811653d21bc6dd152742b086caadcc6dff5e27b40da42c2f1ebf3dd2bd51c418718e499859239317fcab10892eadf1c0ebf7a4246bce4cce3617193032f3e41b977dc8650298ac39631c527460364effea0f0bfd043df72ead0406aba1bcd636d65d7b89979eb8e1";
jump75000  = "831057c079d65a2e31535abcd98fbad359ff5cb37bd7cc93543a3637e8853db0fc5faf66f9f1f6ba73eae05eca5cf550fff12db6e33e8103605d10aabdf3d5b07165fcecf81ffd33301aea776d737806431f757532b0e0e016d281a3c9fd717e8f755d3aa439d19fd24d0ad53d8cb5f27ca0f243726894f7c837cb5adc2781f8b633275b48ca208ca57947a9ae1ec3bbd3d6647e99435440fb5f3cff7f19cc3bd336d7eac4e46f4f6b84c648c7d697ea6528912bfd5c7c92e3e41cd07c8294c1e68c0f4b2c8821e512282ad9d36dd91ebaeddb223f916138a845aee941f102fcdc04266f9b20bb4d5c0a54de5c89e2ee254c834bba3441a32ea50402dd49c3dd2d44bbcd31c233901941f795d49af805ce838ebbd7e3d20c3490d6bd16d1b6bb782bb69a2c0c1dca7a996e6bc90905f91aa8d61c88bc069638b05d1b9d32d16f0d0eb13dfc5ea95de02bf1c7a52acc41a44ff0135591ee42c3b1f7e3b449ad4534472fb1fafe04332aa58f305cffbd483aeac965c77f872344f203e5ac2f20e75c795297ef0dbf9484aba1f7322b1e270c920f5c6fd73f1a033e7a1b4829d4f621bf49cac5a51a9561b28573c4f63d4fbbb801395590baafd925ad3f012752a5dc7711339c37dd7cfcf4ff05f66a79dbbde01727c8334d36e7601f7c2fe7a9c4d9701e39312825f237a504da702aced989c2ee474cb63f76f496c1e6efb5255206cb1a1c7bd691a8876e7dc0502754d238838db79e55e9059712b8b7d52b61e7fae9eb5d07f7f82c62dd7b2f5482da8298859b4d18fe108353e492449cee2e8d5c2214ac346570f7fef40be054189e12e3c408a7ffc8b0bf7c7020d32ae59ff79a35c5b33818469c8260d1ef8eb7b6d96d15d0daf0d5738ba1600dd9f9742a90d553e026a9baa22d442bffabf9fcb4cde765680a4bab225528af546426c10e9e173dbe87335dd395826efb7ae0406bc12fbe154c18b8fa60d8edb4bae19d9a2a065d61513ee7babdd0f315bdb9059f52c759fb34292973831e2e1f332216ac9a79a5d8c1d668c8a46d7a238f7c29a56ca2f70dcb5566ad86ea6328dc5cc4587650d0ab2919820be35a42d14b5ee8e527da4d1dbe7af562ecf26d59f5a3a6cc1fac46dd4b8b41008007933aac430d7b5488e51241928f08b25de0380b2cfa7b2d3af4101e9fd68720021198b0740af25470b5446e0ba4c88ddbe0de3d55c0b4f87373c5288a3607aa10c072b4f1b1a66bfd8822f427b4a735f22bbd1e2522e1918bffa59346dcbeacb6f04264377bd905e25454b8ec3ead92863bbac8d4cf316257318b83bdeda6aa57582c44b1639e13cce6f970547ca215a60c9252a4e78cb5c669339a663ada07dc1aed3650c2af17e0a7f8e50818caedef84841b451279b483a2c8bf403bce949cecb40c0f7e8aaa064d85c0b9283a8f99e740a433108f58a368befec7805f201ae755b1d092e33cb70afd1fc09d79d1f9737d5b567ac7d797cf20e257d4d277d2887032c0b4be1960df14fb22f6e6a689d40bae65e0a2f413e157ce97d34183dc4b72bf43f388d39837680c495bde793009ab7bad2a13c38b50322e262028d7ab7f3a91ae48a1f50d9dc09b8eca2c37a162606223bb66d1cf254f349c919890eabc74cf9a70c95e03b56980f1659f9f48e88981bd7f18e5036b169afdf5fc4b4a87cca26a5e8da5c52d1633866b4569cc2cedaef7ab2593ec9cabb4620b12931c9f9e79328f84b7ef530d40af6c964d4db5bcbf663654f06db29a555dfcdcbcfa2fcdca79ef50eded1828391106527d28d525b76da8efe6037fbefe958f11838e530abd48bf5d8c8e608c6cabbc9f52484296fe731f09afbb66a3c59f5b064ac83eec5395b66290eb2e81b553ef7e9e64ef91688d6aa3f060377d01e4bf812dfa0e070f15c369d9bdbc9386b9c2536db48e5234b62d111f28e88af5eadf430a0d9c423ba17fe8bba0b394c4d07c6b83a6061bb154dfc5aaaae696a4be1a7ccc0ee1a9e979faae51fe98c81f046bdd9a3f2f2efd872470afa30f376aa1219a829ed34580b443461e978decff504168ace065b1fe23a93914ee28333df1e31b33087755f2ed98e9390132bf805c0bc444d6d2110f274b058aeae577883f9f719695aabe89fc42170a17797630ccd31fce21ab1b9fc9dffb94de2cacbf39cbf9e8ca500cca52e2e3cad7e9c51392bb7370a618a70c8cd8358f69a4d9de7fba902f15bc127dbf8463a0883ca0c5ade3ea5aed80aa84573e0f65b3ec65bf5af70935be2e0acc0ed61a5c686218018e3f72996897c90bc81bd110eb5f7f7ca29c26dbd4d49c64b35aa35cf63b9dc6b16e47cb4cf8caf9181a9d7274be302ad2cfa92301afeebe3be30b964350906681e12041262071b5e7e30032df9422217f5b212b4c7019744e944e0859fc7c5503218d4b3e618f3f53ecb5e3ef182ce0eccbb4d630e1379b729f7bcd94efa9dad514e7168eb9ac81c2ce1b200b7fd82393ae8de32e277e79d0f4541da9b7bdf8b4f594beb9743ec55e1f639ce82170b758efe8a908fc38fe4a668b9968716b6f1463c87e3eec10a67be621b6857639c64d38ddc1a199d4a6c99df02460fa582877fc626f9128d87e7e002a5692139a75c06857931fd5ceb741ad58997253e9d7ae19393a20c2db305912079b3c3c7ff4e40549faf3fac8184efe8d3b0a06e7960bd6ce43115a44ea222461c30300ee3e72f6aae5203905762938e31b6d05b98b74d5fb733be313160e84967316b4a2668b2f0ae3e9b05210256c58122a55b64b1ea11a34d866748d91192591bfe6a03f19aad649954ae56804dc8c603454e1cd744a78574d344e2bcd273bfd2988d5a67a284e5582e92be7687dc0a4cd2e9187b73ec37503607eecb3c87243e54527fc07dd2b713365a03ac02297ef1b65dd324598078eea584f0d3793db9f65201488a244d4f76a1d19dbd83e3b214a58fbccd1f4c81f381f5270ce96c7fd5c91b936d2142f7e301d5348ce85858e9fd2747131385eb8a3f95011d108b85cfb12b5de4f02f02b6e0324788e4c6caa3af6e18d608ad7f5b5a74ec9249f0b4872b83334efb54e64756630675e1deb1e24b3e8288127fc3017dd6a78fbfa5bac09b96b7210dbba687ed6a54a8c3c9f0c8a149b6cdc3a953e27e3498bcb676cae0bd8ae731083c829217ce4aa2300c4b7351239f2a7b8a662596adfe556aa51e7cfffe5644e93cb87ae7f7c98c28dd0e865bc9359efb6b2b0bdc6018da4aed0319c96f4a1c5935164345707740e69c697c5cee6d7221257bee5a4fedfc4ef6b056d32f7de22333f8d5b6b068eec2a3150dc95f049b137d709e6f81a41e356368d8197b256535fbf26826101cb50d22b6af3284a7e9a69fd15a5c4d2deebbee3d6af2506af3186860c8564bcff19518f951537126a2bd5b5e47115bebf8e5251578e1a88763b955b0faa7c3e5cc3af95354370ae174dc4882c3a1808aeadb197265b775e16e33ceba9bfc7a3d825d5d4d6052c358f06d0d006140410423e884d6ba2e685890586aa42a1b2c16ffa462d7175fd8a48f3fb06a6e9fe32";

# set up initial position of six MT instances
mts = jump(seed, size, jumppoly=jump25000)

# initialize serial generator
mt = MersenneTwister(seed)

# generate and compare with serial generation
tmp = zeros(Float64, size*step)
for i in 1:1 # TODO several iterations
    for j in 1:step
        tmp[j + 0 * step] = rand(mts[1], Float64)
        tmp[j + 1 * step] = rand(mts[2], Float64)
        tmp[j + 2 * step] = rand(mts[3], Float64)
        tmp[j + 3 * step] = rand(mts[4], Float64)
    end

    print("comparing with serial generation $((i-1)*step*size) to $(i*step*size-1): ")
    for j in 1:(size * step)
        # @test_approx_eq rand(mt, Float64) tmp[j]
        if rand(mt, Float64) != tmp[j]
            error("something wrong! i=$i, j=$j")
        end
    end
    println("OK")
    mts[1] = jump(mts[1], jump75000)
    mts[2] = jump(mts[2], jump75000)
    mts[3] = jump(mts[3], jump75000)
    mts[4] = jump(mts[4], jump75000)
end

# state(mt::MersenneTwister) = reinterpret(UInt64, mt.state.val)

#reinterpret(UInt64, mt.vals[mt.idx+1])
#Base.Random.reserve(mts[1],2)

# Base.Random.reserve_1(mt)
# Base.Random.reserve_1(mts[1])
# nr(r::MersenneTwister) = reinterpret(UInt64, r.vals[r.idx+1]) << 32 $ reinterpret(UInt64, r.vals[r.idx+2])